// Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ­Ø¯Ø© node-fetch Ù„Ø¬Ù„Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©
const fetch = require('node-fetch');

// Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ÙŠØ© ÙˆØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
function welcomeNewMember(member) {
    const groupWelcomeMessage = `
*â€¢â…â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âœ§ð™Žð™ð™‰â˜€âœ§â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â…â€¢*

*â‰ªâ”â”â”â”â”â”â”â”â”â”â”â”â”à¼»ï·½à¼ºâ”â”â”â”â”â”â”â”â”â”â”â”â”â‰«*

*ðŸœ²Ø¨Ø§Ø¬Ù…Ù„ Ø§Ù„ÙƒÙ„Ø§Ù… Ùˆ Ø§Ù„Ù‚Ù„ÙˆØ¨ Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ùˆ Ø§Ù„Ø±ÙˆØ­ Ø§Ù„ØµØ§ÙÙŠØ©ØŒÙ†Ø±Ø­Ø¨ Ø¨Ùƒ ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø§Ù†Ù…ÙŠ Ø§Ù„Ù„ØªÙŠ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø¹ØªØ¨Ø§Ø±Ù‡Ø§ ÙƒØ¹Ø§Ø¦Ù„ØªÙƒØŒÙ†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø§Ù„Ø§Ø³ØªÙ…ØªØ§Ø¹ Ùˆ Ø§Ù„Ø±ÙÙ‡ÙŠØ© Ùˆ Ù…ØªØ­Ù…Ø³ÙˆÙ† Ù„Ø±Ø¦ÙŠØªÙƒ ØªØªÙØ§Ø¹Ù„á°”á©š*

*â¬¤Ø§Ù„Ù€Ù€Ù€Ù€Ù€Ù€Ù…Ù€Ù€Ù€Ù†Ù€Ù€Ù€Ù€Ù€Ù€Ø´Ù†ðŸ“§: ${member.mention()}*
*â€¢â…â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âœ§ð™Žð™ð™‰â˜€âœ§â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â…â€¢*

*ðŸ”´Ù†Ø±Ø¬Ùˆ Ù…Ù†Ùƒ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø§Ø¹Ù„Ø§Ù†Ø§Øª: [https://chat.whatsapp.com/J4aqGdizp16AzAsrfuKAoD] ã€*

*Ù†Ø±Ø¬Ùˆ Ù…Ù†Ùƒ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ùˆ Ø¹Ø¯Ù… Ù…Ø®Ø§Ù„ÙØªÙ‡Ø§ [123OakpGjLKwNgR21SgiEShjQ9hEEtksaf4VIb0dcOv8/edit?usp=drivesdk] ã€*

*â€¢â…â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âœ§ð™Žð™ð™‰â˜€âœ§â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â…â€¢*
    `;

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
    member.reply(*ðŸœ²Ø¨Ø§Ø¬Ù…Ù„ Ø§Ù„ÙƒÙ„Ø§Ù… Ùˆ Ø§Ù„Ù‚Ù„ÙˆØ¨ Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ùˆ Ø§Ù„Ø±ÙˆØ­ Ø§Ù„ØµØ§ÙÙŠØ©ØŒÙ†Ø±Ø­Ø¨ Ø¨Ùƒ ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø§Ù†Ù…ÙŠ Ø§Ù„Ù„ØªÙŠ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø¹ØªØ¨Ø§Ø±Ù‡Ø§ ÙƒØ¹Ø§Ø¦Ù„ØªÙƒØŒÙ†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø§Ù„Ø§Ø³ØªÙ…ØªØ§Ø¹ Ùˆ Ø§Ù„Ø±ÙÙ‡ÙŠØ© Ùˆ Ù…ØªØ­Ù…Ø³ÙˆÙ† Ù„Ø±Ø¦ÙŠØªÙƒ ØªØªÙØ§Ø¹Ù„á°”á©š*);

    // Ø¬Ù„Ø¨ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯
    fetch(member.imgUrl)
        .then(res => res.buffer())
        .then(buffer => {
            // Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
            member.sendImage(buffer, 'profile.jpg', 'ðŸŒŸØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ');
        })
        .catch(console.error);
}

// Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù†Ø¶Ù…Ø§Ù… Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
// ÙŠØ¬Ø¨ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø© ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©
// ÙˆÙƒØ°Ù„Ùƒ Ø¶Ø¨Ø· Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¬Ù„Ø¨ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ù„Ø¹Ø¶Ùˆ
conn.on('group-participants-update', async (event) => {
    const members = event.participants.filter(user => user.isUser);
    for (const member of members) {
        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯ ÙˆÙ„ÙŠØ³ Ø¹Ø¶ÙˆØ§ Ù…ÙˆØ¬ÙˆØ¯Ø§
        if (event.action === 'add') {
            welcomeNewMember(member);
        }
    }
});
